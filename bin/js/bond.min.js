(function(a,f){function c(j,d){return(typeof j===(d||"undefined"))}function e(k){var j=b.l.href.replace(b.h,"").substr(1),d=j.indexOf("?");return k||(d==-1)?j:j.substr(0,d)}function i(q,d){var m=[];for(var n in q){var l=d?d+"["+n+"]":n,j=q[n];l=c(j,"object")?i(j,l):encodeURIComponent(l)+"="+encodeURIComponent(j);m.push(l)}return m.join("&")}var h=this,b={};h.debug=a.console&&a.console.firebug;h.log=h.debug?console.log:function(){};h.html5=(!c(a.history.pushState));h.IE=(!c(a.ActiveXObject)&&!c(f.documentMode)&&f.documentMode<=8);h.onready=function(){};h.oninternalchange=function(){};h.onexternalchange=function(){};b.l=a.location;b.p=a.history;b.s=false;b.t=null;b.h="";b.v="";h.hash=function(k){var j=b.l.href,d=j.indexOf("#");if(d!=-1){j=j.substr(d+1);d=j.indexOf("?");return k||(d==-1)?j:j.substr(0,d)}else{return""}};h.host=function(){if(arguments.length==0){return b.gh()}else{b.sh(arguments[0])}};b.gh=function(){return b.h};b.sh=function(d){b.h=d.indexOf("http")!=-1?d:b.l.protocol+"//"+d;if(b.h.charAt(b.h.length-1)=="/"){b.h=b.h.substr(0,b.h.length-1)}};b.r=function(){if((h.hash().length!=0)&&h.html5){b.p.pushState({},"",h.hash(true));b.l.hash=""}b.v=!h.html5?h.hash(true):e(true)};h.value=function(){if(arguments.length==0){return b.gv()}else{b.sv(arguments[0],arguments[1]||null)}};b.gv=function(){return b.v};b.sv=function(d,j,k){k=!c(k)?k:true;if(b.v==d&&b.q==j){return}if(h.debug&&k){h.log("internal change",b.v,"=>",d)}b.v=d;if(j!=null){b.v+="?"+i(j)}if(h.html5){b.p.pushState({},"",b.v)}else{if(h.IE){if(h.debug){log("using iframe")}if(c(b.i)){b.i=f.createElement("iframe");b.i.src="javascript:void(0)";b.i.style.display="none";b.i.tabindex=-1;b.i.title=f.getElementsByTagName("title")[0].innerHTML;f.appendChild(b.i);b.icd=b.i.contentWindow.d}b.icd.open();b.icd.write(("<html><body>%v</body></html>").replace("%v",b.v));b.icd.close();b.icd.location.hash=b.v}b.l.hash=b.v}if(k){h.oninternalchange("internal",b.v,h.parameters())}};h.url=function(d,j){b.sv(d,j,false)};h.simulate=function(j,k){k=!c(k)?k:null;var d=j;if(k!=null){d+="?"+i(k)}if(h.html5){b.p.pushState({},"",d)}else{b.l.hash=d}};h.path=function(){var j=b.v.indexOf("?"),d=j!=-1?b.v.substr(0,j):b.v;return d.split("/")};h.parameters=function(m){var k=h.html5?e(true):h.hash(true),n=k.indexOf("?"),k=n!=-1?k.substr(n+1):"";if(k.length==0){return m?"null":null}var r=k.split("&"),q={};for(var n=0,d=r.length,s;n<d;n++){s=r[n].split("=");q[s[0]]=!c(s[1])?s[1]:null}return m?JSON.stringify(q):q};b.c=function(j){var d=false,k=b.v,l="";if(!h.html5){l=h.hash(true);if(d=(b.v!=l)){b.v=l;if(!c(b.i)){b.icd.location.hash=l}}else{if(d=(!c(b.i)&&(b.icd.location.hash.substr(1)!=l))){l=b.icd.location.hash.substr(1);b.v=b.l.hash=l}}}else{l=e(true);if(d=(b.v!=l)){b.v=l}}if(d){if(h.debug){h.log("external change","'"+k+"'","=>","'"+l+"'")}h.onexternalchange("external",b.v,h.parameters())}};h.activate=function(){if(!b.s){if((b.z=(!h.html5&&"onhashchange" in a&&"addEventListener" in a))){a.addEventListener("hashchange",b.c,false)}else{b.t=setInterval(b.c,25)}b.s=true}};h.deactivate=function(){if(b.s){if(b.z){a.removeEventListener("hashchange",b.c,false)}else{clearInterval(b.t)}b.s=false}};h.initialize=function(n){n=n||{};var m=["debug","log","html5","IE","onready","oninternalchange","onexternalchange"];for(var k=0,j=m.length;k<j;k++){if(m[k] in n){h[m[k]]=n[m[k]]}}var d=f.getElementsByTagName("base");if(d==null||d.length==0){throw new Error("undefined <base> tag")}if(h.swf){b.swf=f.getElementById(h.swf);h.onready=h.oninternalchange=h.onexternalchange=function(p,l,o){b.swf.bond(p,l,o)}}h.host(d[0].href);b.r();if(h.debug){h.log("bond ready","'"+b.v+"'")}h.onready("ready",b.v,h.parameters());h.activate();b.c()};if(!c(a.swfobject)){var g=swfobject.embedSWF;swfobject.embedSWF=function(){var d=[].slice.call(arguments);h.swf=d[1];if(c(d[8])){d[8]={}}if(c(d[8].id)){d[8].id=d[1]}g.apply(this,d)}}}).call(window.bond={},window,document);